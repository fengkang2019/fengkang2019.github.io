{"version":3,"sources":["scripts/views/rolemanage/index.js","../node_modules/_rc-calendar@9.15.5@rc-calendar/es/locale/zh_CN.js","../node_modules/_antd@3.23.3@antd/es/time-picker/locale/zh_CN.js","../node_modules/_antd@3.23.3@antd/es/date-picker/locale/zh_CN.js"],"names":["RangePicker","DatePicker","MonthPicker","error","WeekPicker","message","info","RoleManage","connect","state","staffs","getIn","name","entrytime","reason","showDrawer","e","setState","visible","target","parentNode","firstElementChild","innerHTML","props","dispatch","getName","nextElementSibling","getentrytime","onClose","submitApply","one","value","getReason","axios","url","params","dimissiontime","format","Date","now","showModal","visible2","console","log","handleOk","val","confirmLoading","inp","starttime","endtime","setTimeout","handleCancel","onChange","date","dateString","handleDate","time","moment","subtract","this","getStaffs","ModalText","id","summary","map","staff","i","key","onClick","width","title","placement","closable","getContainer","style","position","className","placeholder","ref","el","size","type","onOk","onCancel","required","locale","disabledDate","Component","_extends","Object","assign","arguments","length","source","prototype","hasOwnProperty","call","apply","lang","rangePlaceholder","today","backToToday","ok","timeSelect","dateSelect","weekSelect","clear","month","year","previousMonth","nextMonth","monthSelect","yearSelect","decadeSelect","yearFormat","dayFormat","dateFormat","dateTimeFormat","previousYear","nextYear","previousDecade","nextDecade","previousCentury","nextCentury","timePickerLocale"],"mappings":"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","file":"static/js/16.62452fe8.chunk.js","sourcesContent":["import \"./index.scss\";\r\n\r\nimport { Modal, Button, Input, message, Drawer, DatePicker } from 'antd';\r\n\r\nimport moment from \"moment\";\r\nimport { connect } from \"react-redux\";\r\nimport locale from 'antd/es/date-picker/locale/zh_CN'\r\nimport { getStaffs, getName, getentrytime, getReason } from \"../../../immutable/actions\";\r\n\r\nimport { axios, format } from \"&\";\r\n\r\nconst { MonthPicker, RangePicker, WeekPicker } = DatePicker;\r\nconst error = () => {\r\n    message.error('该同事已离职,无法进行操作');\r\n};\r\nconst info = () => {\r\n    message.info('请将请假申请填写完整');\r\n};\r\n@connect(\r\n    state => ({\r\n        staffs: state.getIn(['staff', 'staffs']),\r\n        name: state.getIn(['dimission', 'name']),\r\n        entrytime: state.getIn(['dimission', 'entrytime']),\r\n        reason: state.getIn(['dimission', 'reason'])\r\n    })\r\n)\r\nexport default class RoleManage extends Component {\r\n    constructor() {\r\n        super();\r\n        this.state = {\r\n            visible: false,\r\n            visible2: false,\r\n            confirmLoading: false,\r\n            starttime: \"\",\r\n            endtime: \"\",\r\n            name: \"\",\r\n        }\r\n    }\r\n    componentDidMount() {\r\n        this.props.dispatch(getStaffs({\r\n            url: \"/react/getStaff\",\r\n        }))\r\n    }\r\n    showDrawer = (e) => {\r\n        this.setState({\r\n            visible: true,\r\n        });\r\n        let name = e.target.parentNode.parentNode.firstElementChild.innerHTML;\r\n        this.props.dispatch(getName(name))\r\n        let entrytime = e.target.parentNode.parentNode.firstElementChild.nextElementSibling.innerHTML;\r\n        this.props.dispatch(getentrytime(entrytime))\r\n    };\r\n    onClose = () => {\r\n        this.setState({\r\n            visible: false,\r\n        });\r\n    };\r\n    submitApply = (name, entrytime) => {\r\n        this.setState({\r\n            visible: false,\r\n        });\r\n        let reason = this.one.value;\r\n        this.props.dispatch(getReason(reason))\r\n        axios({\r\n            url: \"/react/addDimission\", params: {\r\n                name,\r\n                entrytime,\r\n                reason,\r\n                dimissiontime: format(Date.now()),\r\n                state: false,\r\n            }\r\n        })\r\n    }\r\n    showModal = (e) => {\r\n        this.setState({\r\n            visible2: true,\r\n        });\r\n        console.log(e.target.parentNode.parentNode.firstElementChild.innerHTML);\r\n        let name = e.target.parentNode.parentNode.firstElementChild.innerHTML;\r\n        this.setState({\r\n            name,\r\n        })\r\n    };\r\n\r\n    handleOk = (val) => {\r\n        this.setState({\r\n            confirmLoading: true,\r\n        });\r\n\r\n        let reason = this.inp.value\r\n        let starttime = this.state.starttime;\r\n        let endtime = this.state.endtime;\r\n        console.log(reason, starttime, endtime)\r\n        if (reason && starttime && endtime) {\r\n            setTimeout(() => {\r\n                axios({\r\n                    url: \"/react/addAsk\",\r\n                    params: {\r\n                        name: this.state.name,\r\n                        starttime,\r\n                        endtime,\r\n                        reason,\r\n                        state: false,\r\n                    }\r\n                })\r\n            }, 1500);\r\n        } else {\r\n            info();\r\n        }\r\n\r\n        this.setState({\r\n            visible2: false,\r\n            confirmLoading: false,\r\n        });\r\n    };\r\n\r\n    handleCancel = () => {\r\n        this.setState({\r\n            visible2: false,\r\n        });\r\n    };\r\n    onChange = (date, dateString) => {\r\n        let starttime = dateString[0];\r\n        let endtime = dateString[1];\r\n        console.log(starttime, endtime)\r\n        this.setState({\r\n            starttime,\r\n            endtime,\r\n        })\r\n\r\n    }\r\n    handleDate = (time) => {\r\n        if (!time) {\r\n            return false\r\n        } else {\r\n            // 大于当前日期不能选 time > moment()\r\n            return time < moment().subtract(1, \"days\")\r\n            // 小于当前日期不能选 \r\n            // 只能选前7后7 time < moment().subtract(7, \"days\") || time > moment().add(7, 'd')\r\n            // return time < moment().subtract(7, \"days\") || time > moment().add(7, 'd')\r\n        }\r\n    }\r\n    render() {\r\n        const { staffs, name, entrytime } = this.props;\r\n        const { visible2, ModalText, confirmLoading } = this.state;\r\n        return (\r\n            <div id=\"role\">\r\n                <h2>员工管理表格</h2>\r\n                <table summary=\"该表格为操作员工离职和请假两大事项所用\">\r\n                    <tbody>\r\n                        <tr>\r\n                            <td>\r\n                                姓名\r\n                            </td>\r\n                            <td>\r\n                                入职时间\r\n                            </td>\r\n                            <td>\r\n                                状态\r\n                            </td>\r\n                            <td>\r\n                                操作\r\n                            </td>\r\n                        </tr>\r\n\r\n                        {\r\n                            staffs.map((staff, i) => {\r\n                                return (\r\n                                    <tr\r\n                                        key={i}>\r\n                                        <td>\r\n                                            {staff.name}\r\n                                        </td>\r\n                                        <td>\r\n                                            {staff.entrytime}\r\n                                        </td>\r\n                                        <td>\r\n                                            {!staff.state ? \"在职\" : \"已离职\"}\r\n                                        </td>\r\n                                        <td>\r\n                                            <span onClick={!staff.state ? this.showDrawer : error}>办理离职申请</span>\r\n                                            <span onClick={!staff.state ? this.showModal : error}>办理请假申请</span>\r\n                                            <Drawer\r\n                                                width=\"800px\"\r\n                                                title=\"离职申请\"\r\n                                                placement=\"right\"\r\n                                                closable={false}\r\n                                                onClose={this.onClose}\r\n                                                visible={this.state.visible}\r\n                                                getContainer={false}\r\n                                                style={{ position: 'absolute' }}\r\n                                            >\r\n                                                <textarea name=\"text\"\r\n                                                    className=\"text\"\r\n                                                    placeholder=\"请输入申请理由\"\r\n                                                    ref={el => this.one = el}\r\n                                                ></textarea>\r\n\r\n                                                <Button size=\"large\" type=\"danger\" className=\"btn\" onClick={() => this.submitApply(name, entrytime)}>提交申请</Button>\r\n                                            </Drawer>\r\n                                            <Modal\r\n                                                title=\"离职申请单\"\r\n\r\n                                                visible={visible2}\r\n                                                onOk={this.handleOk}\r\n                                                confirmLoading={confirmLoading}\r\n                                                onCancel={this.handleCancel}\r\n                                            >\r\n                                                <textarea\r\n                                                    className=\"inp\"\r\n                                                    placeholder=\"请输入请假理由\"\r\n                                                    ref={el => this.inp = el}\r\n                                                    required\r\n                                                >\r\n                                                </textarea>\r\n                                                <RangePicker\r\n                                                    locale={locale}\r\n                                                    onChange={this.onChange}\r\n                                                    disabledDate={this.handleDate} />\r\n                                            </Modal>\r\n                                        </td>\r\n                                    </tr>\r\n                                )\r\n                            })\r\n                        }\r\n                    </tbody>\r\n                </table>\r\n\r\n            </div>\r\n        )\r\n    }\r\n\r\n}","export default {\n  today: '今天',\n  now: '此刻',\n  backToToday: '返回今天',\n  ok: '确定',\n  timeSelect: '选择时间',\n  dateSelect: '选择日期',\n  weekSelect: '选择周',\n  clear: '清除',\n  month: '月',\n  year: '年',\n  previousMonth: '上个月 (翻页上键)',\n  nextMonth: '下个月 (翻页下键)',\n  monthSelect: '选择月份',\n  yearSelect: '选择年份',\n  decadeSelect: '选择年代',\n  yearFormat: 'YYYY年',\n  dayFormat: 'D日',\n  dateFormat: 'YYYY年M月D日',\n  dateTimeFormat: 'YYYY年M月D日 HH时mm分ss秒',\n  previousYear: '上一年 (Control键加左方向键)',\n  nextYear: '下一年 (Control键加右方向键)',\n  previousDecade: '上一年代',\n  nextDecade: '下一年代',\n  previousCentury: '上一世纪',\n  nextCentury: '下一世纪'\n};","var locale = {\n  placeholder: '请选择时间'\n};\nexport default locale;","function _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nimport CalendarLocale from \"rc-calendar/es/locale/zh_CN\";\nimport TimePickerLocale from '../../time-picker/locale/zh_CN';\nvar locale = {\n  lang: _extends({\n    placeholder: '请选择日期',\n    rangePlaceholder: ['开始日期', '结束日期']\n  }, CalendarLocale),\n  timePickerLocale: _extends({}, TimePickerLocale)\n}; // should add whitespace between char in Button\n\nlocale.lang.ok = '确 定'; // All settings at:\n// https://github.com/ant-design/ant-design/blob/master/components/date-picker/locale/example.json\n\nexport default locale;"],"sourceRoot":""}